{
  "paragraphs": [
    {
      "text": "%md\n### Statistics collection \u0026 propagation\n\n* see how statistics are collected and used when the data is taken directly from the path\n* see how it changes when metastore is used\n* run ANALYZE TABLE and see it again\n* compute stats for individual cols and see the difference\n* compute the histogram\n* see what impact has if a table is partitoned",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:51:43.065",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eStatistics collection \u0026amp; propagation\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003esee how statistics are collected and used when the data is taken directly from the path\u003c/li\u003e\n  \u003cli\u003esee how it changes when metastore is used\u003c/li\u003e\n  \u003cli\u003erun ANALYZE TABLE and see it again\u003c/li\u003e\n  \u003cli\u003ecompute stats for individual cols and see the difference\u003c/li\u003e\n  \u003cli\u003ecompute the histogram\u003c/li\u003e\n  \u003cli\u003esee what impact has if a table is partitoned\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574189_-752022768",
      "id": "20191207-130706_1973703296",
      "dateCreated": "2019-12-07 14:49:34.189",
      "dateStarted": "2019-12-07 14:51:43.065",
      "dateFinished": "2019-12-07 14:51:43.069",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// Path to the data:\n\nval basePath \u003d  sys.env(\"ZEPPELIN_NOTEBOOK_DIR\").split(\"/\").dropRight(1).mkString(\"/\")\n\nval usersInputPath \u003d basePath + \"/data/users\"\nval usersOutputPath \u003d basePath + \"/output/users\"",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.190",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574190_1546183910",
      "id": "paragraph_1575230892473_-230524676",
      "dateCreated": "2019-12-07 14:49:34.190",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Check CBO",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.190",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eCheck CBO\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574190_-1609093118",
      "id": "paragraph_1575230597809_-1522683249",
      "dateCreated": "2019-12-07 14:49:34.190",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:50:29.879",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": false,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_-1137166164",
      "id": "paragraph_1575230636419_-335788280",
      "dateCreated": "2019-12-07 14:49:34.191",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val usersDF \u003d spark.read.parquet(usersInputPath)",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.191",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": false,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_1563280759",
      "id": "paragraph_1575230696510_225834298",
      "dateCreated": "2019-12-07 14:49:34.191",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Create view from the DataFrame\n\nHint:\n\n* use createOrReplaceTempView\n* the reason why we do it is that we want to write SQL: explain cost to see the plan with stats",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:51:59.727",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eCreate view from the DataFrame\u003c/h4\u003e\n\u003cp\u003eHint:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003euse createOrReplaceTempView\u003c/li\u003e\n  \u003cli\u003ethe reason why we do it is that we want to write SQL: explain cost to see the plan with stats\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_-390342717",
      "id": "paragraph_1575231292801_656111178",
      "dateCreated": "2019-12-07 14:49:34.191",
      "dateStarted": "2019-12-07 14:51:59.727",
      "dateFinished": "2019-12-07 14:51:59.730",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here:",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:52:12.560",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_1517767984",
      "id": "paragraph_1575231320892_1752203464",
      "dateCreated": "2019-12-07 14:49:34.191",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the query plan with stats\n\nHint:\n\n* run sql EXPLAIN COST on query with filter user_id \u003c -1000",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:52:14.764",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee the query plan with stats\u003c/h4\u003e\n\u003cp\u003eHint:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003erun sql EXPLAIN COST on query with filter user_id \u0026lt; -1000\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_-1790643185",
      "id": "paragraph_1575231476940_-83413734",
      "dateCreated": "2019-12-07 14:49:34.191",
      "dateStarted": "2019-12-07 14:52:14.764",
      "dateFinished": "2019-12-07 14:52:14.767",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:52:46.529",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_1369518883",
      "id": "paragraph_1575314971994_-2105488670",
      "dateCreated": "2019-12-07 14:49:34.191",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Access the data throug metastore\n\n* Use spark.table\n* The name of the table is users\n* You may wan to check if the table exists by calling SQL: show tables",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:57:24.492",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eAccess the data throug metastore\u003c/h4\u003e\n\u003cul\u003e\n  \u003cli\u003eUse spark.table\u003c/li\u003e\n  \u003cli\u003eThe name of the table is users\u003c/li\u003e\n  \u003cli\u003eYou may wan to check if the table exists by calling SQL: show tables\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574191_-864148629",
      "id": "paragraph_1575314978166_-970040033",
      "dateCreated": "2019-12-07 14:49:34.191",
      "dateStarted": "2019-12-07 14:57:24.492",
      "dateFinished": "2019-12-07 14:57:24.495",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:54:33.461",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_93258624",
      "id": "paragraph_1575315057461_1912232642",
      "dateCreated": "2019-12-07 14:49:34.192",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the statistics for the table\n\nHint\n\n* use sql DESC EXTENDED",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:54:40.664",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee the statistics for the table\u003c/h4\u003e\n\u003cp\u003eHint\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003euse sql DESC EXTENDED\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_-1548417921",
      "id": "paragraph_1575315059407_1946858652",
      "dateCreated": "2019-12-07 14:49:34.192",
      "dateStarted": "2019-12-07 14:54:40.664",
      "dateFinished": "2019-12-07 14:54:40.667",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:54:56.040",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_-1821708083",
      "id": "paragraph_1575315062246_562386941",
      "dateCreated": "2019-12-07 14:49:34.192",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Compute the statistics\n\nHint\n\n* run sql ANALYZE TABLE ... COMPUTE STATISTICS",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:54:59.455",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eCompute the statistics\u003c/h4\u003e\n\u003cp\u003eHint\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003erun sql ANALYZE TABLE \u0026hellip; COMPUTE STATISTICS\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_1516567208",
      "id": "paragraph_1575315125916_511617739",
      "dateCreated": "2019-12-07 14:49:34.192",
      "dateStarted": "2019-12-07 14:54:59.456",
      "dateFinished": "2019-12-07 14:54:59.459",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:55:08.157",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_1330933282",
      "id": "paragraph_1575315128867_1427272487",
      "dateCreated": "2019-12-07 14:49:34.192",
      "dateStarted": "2019-12-07 14:55:08.176",
      "dateFinished": "2019-12-07 14:55:08.250",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the stats again\n\n* you need to refresh the table to invalidate the previous stats\n* use SQL: refresh table",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:58:37.175",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee the stats again\u003c/h4\u003e\n\u003cul\u003e\n  \u003cli\u003eyou need to refresh the table to invalidate the previous stats\u003c/li\u003e\n  \u003cli\u003euse SQL: refresh table\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_1149035550",
      "id": "paragraph_1575315212295_1899646874",
      "dateCreated": "2019-12-07 14:49:34.192",
      "dateStarted": "2019-12-07 14:58:37.175",
      "dateFinished": "2019-12-07 14:58:37.178",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:55:29.184",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_-938260961",
      "id": "paragraph_1575315224819_-1992405238",
      "dateCreated": "2019-12-07 14:49:34.192",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the query plan for the query again\n\n* what are the stats now?\n* is it compatible with stats computed in metastore?",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:58:48.689",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee the query plan for the query again\u003c/h4\u003e\n\u003cul\u003e\n  \u003cli\u003ewhat are the stats now?\u003c/li\u003e\n  \u003cli\u003eis it compatible with stats computed in metastore?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574192_493193930",
      "id": "paragraph_1575315245149_-617875177",
      "dateCreated": "2019-12-07 14:49:34.192",
      "dateStarted": "2019-12-07 14:58:48.689",
      "dateFinished": "2019-12-07 14:58:48.692",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:59:08.631",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574193_1386764015",
      "id": "paragraph_1575315259406_-1930134814",
      "dateCreated": "2019-12-07 14:49:34.193",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n### Now see what happens if cbo is OFF:\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.193",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eNow see what happens if cbo is OFF:\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574193_2083800218",
      "id": "20191207-133451_225484796",
      "dateCreated": "2019-12-07 14:49:34.193",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:59:15.595",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574193_348481565",
      "id": "20191207-132417_1730595930",
      "dateCreated": "2019-12-07 14:49:34.193",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n### Nothing changed - stats are cached",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.193",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eNothing changed - stats are cached\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574193_-1082366579",
      "id": "20191207-133702_746319632",
      "dateCreated": "2019-12-07 14:49:34.193",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// invalidate cache",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:59:49.016",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574193_315243643",
      "id": "20191207-132809_1520640552",
      "dateCreated": "2019-12-07 14:49:34.193",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// see again ",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:59:58.447",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574194_-1994965201",
      "id": "20191207-132701_155784056",
      "dateCreated": "2019-12-07 14:49:34.194",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n### Turn CBO back to ON",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.194",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eTurn CBO back to ON\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574194_-166870436",
      "id": "20191207-134541_1915421411",
      "dateCreated": "2019-12-07 14:49:34.194",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.conf.set(\"spark.sql.cbo.enabled\", true)\n\nspark.sql(\"refresh table users\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.194",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574194_1819627107",
      "id": "20191207-134520_1530507366",
      "dateCreated": "2019-12-07 14:49:34.194",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See column level stats\n\nHint\n* use DESC EXTENDED table_name, col_name",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.194",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee column level stats\u003c/h4\u003e\n\u003cp\u003eHint\u003cbr/\u003e* use DESC EXTENDED table_name, col_name\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574194_-613808168",
      "id": "paragraph_1575315277037_-1859781353",
      "dateCreated": "2019-12-07 14:49:34.194",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:00:39.094",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574194_917454352",
      "id": "paragraph_1575315292708_-1171760302",
      "dateCreated": "2019-12-07 14:49:34.194",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Compute column level stats\n\nHint:\n* use ANALYZE TABLE table_name COMPUTE STATISTICS FOR COLUMNS col_names",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.195",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eCompute column level stats\u003c/h4\u003e\n\u003cp\u003eHint:\u003cbr/\u003e* use ANALYZE TABLE table_name COMPUTE STATISTICS FOR COLUMNS col_names\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574194_1670496980",
      "id": "paragraph_1575315308755_-1987522800",
      "dateCreated": "2019-12-07 14:49:34.194",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:00:43.294",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574195_1386712638",
      "id": "paragraph_1575315331824_-1827861386",
      "dateCreated": "2019-12-07 14:49:34.195",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.195",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee the stats again\u003c/h4\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574195_-1745189511",
      "id": "paragraph_1575315350861_449754157",
      "dateCreated": "2019-12-07 14:49:34.195",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:00:46.557",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574195_78498624",
      "id": "paragraph_1575315364829_1810478341",
      "dateCreated": "2019-12-07 14:49:34.195",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Compute the histogram for specific cols\n\nHint\n\n* Check if histogram is enabled\n* Enable if not\n* Compute column level stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:01:06.897",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eCompute the histogram for specific cols\u003c/h4\u003e\n\u003cp\u003eHint\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eCheck if histogram is enabled\u003c/li\u003e\n  \u003cli\u003eEnable if not\u003c/li\u003e\n  \u003cli\u003eCompute column level stats again\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574195_1645110839",
      "id": "paragraph_1575315394248_-2039248615",
      "dateCreated": "2019-12-07 14:49:34.195",
      "dateStarted": "2019-12-07 15:01:06.897",
      "dateFinished": "2019-12-07 15:01:06.900",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:01:25.983",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574195_-590535661",
      "id": "paragraph_1575315412599_1323001613",
      "dateCreated": "2019-12-07 14:49:34.195",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.195",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch4\u003eSee the stats again\u003c/h4\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574195_-1692823043",
      "id": "paragraph_1575315461735_-2141789712",
      "dateCreated": "2019-12-07 14:49:34.195",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:01:48.972",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_1698719359",
      "id": "paragraph_1575315474524_1196017264",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n### Let\u0027s see what happens if the table is partitoned\n\n* use table usersp - it is partitioned  ",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.196",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eLet\u0026rsquo;s see what happens if the table is partitoned\u003c/h3\u003e\n\u003cul\u003e\n  \u003cli\u003euse table usersp - it is partitioned\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_-1945870085",
      "id": "paragraph_1575403687493_1105472643",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:01:59.556",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_55362272",
      "id": "20191207-135232_1351208387",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n### change defaultSizeInBytes config",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.196",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003echange defaultSizeInBytes config\u003c/h3\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_-2086614843",
      "id": "20191207-140557_909006797",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:02:18.523",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_-1282723019",
      "id": "20191207-135315_50659264",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// check the plan again",
      "user": "anonymous",
      "dateUpdated": "2019-12-07 15:02:55.040",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_-1938932082",
      "id": "20191207-140240_1294641584",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "user": "anonymous",
      "dateUpdated": "2019-12-07 14:49:34.196",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575726574196_193216995",
      "id": "20191207-140247_1478976337",
      "dateCreated": "2019-12-07 14:49:34.196",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "assignments/cbo/cbo-I",
  "id": "2EVYTDK6V",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}