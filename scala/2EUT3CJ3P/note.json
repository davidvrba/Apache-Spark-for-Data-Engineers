{
  "paragraphs": [
    {
      "text": "%md \n## Task: see how statistics are used\n\u003cbr\u003e\n* turn CBO on\n* save dataframe as table using metastore\n* run simple query and see the query plan with stats using EXPLAIN COST\n* run ANALYZE TABLE and see it again\n* compute stats for individual cols and see the difference\n* compute the histogram",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:09.767",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232008_1189845734",
      "id": "paragraph_1575230573546_-1291087309",
      "dateCreated": "2019-12-06 07:20:32.008",
      "dateStarted": "2019-12-06 07:24:09.819",
      "dateFinished": "2019-12-06 07:24:09.829",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val usersInputPath \u003d \"/home/student/Apache-Spark-for-Data-Engineers/data/users\"\nval usersOutputPath \u003d \"/home/student/Apache-Spark-for-Data-Engineers/output/users\"\n\nval tableName \u003d \"users\"\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:26:25.602",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232013_-1723959978",
      "id": "paragraph_1575230892473_-230524676",
      "dateCreated": "2019-12-06 07:20:32.013",
      "dateStarted": "2019-12-06 07:24:09.980",
      "dateFinished": "2019-12-06 07:24:10.148",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n### Check CBO",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:10.182",
      "config": {
        "tableHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": false,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232015_1820613419",
      "id": "paragraph_1575230597809_-1522683249",
      "dateCreated": "2019-12-06 07:20:32.015",
      "dateStarted": "2019-12-06 07:24:10.225",
      "dateFinished": "2019-12-06 07:24:10.228",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.conf.get(\"spark.sql.cbo.enabled\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:10.328",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": false,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232017_1369917095",
      "id": "paragraph_1575230636419_-335788280",
      "dateCreated": "2019-12-06 07:20:32.017",
      "dateStarted": "2019-12-06 07:24:10.364",
      "dateFinished": "2019-12-06 07:24:10.533",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.conf.set(\"spark.sql.cbo.enabled\", true)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:10.565",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232018_525273702",
      "id": "paragraph_1575403707199_1417221082",
      "dateCreated": "2019-12-06 07:20:32.018",
      "dateStarted": "2019-12-06 07:24:10.603",
      "dateFinished": "2019-12-06 07:24:10.742",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val usersDF \u003d spark.read.parquet(usersInputPath)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:10.808",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": false,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://10.13.4.90:4041/jobs/job?id\u003d2"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1575613232019_1362708119",
      "id": "paragraph_1575230696510_225834298",
      "dateCreated": "2019-12-06 07:20:32.019",
      "dateStarted": "2019-12-06 07:24:10.835",
      "dateFinished": "2019-12-06 07:24:11.171",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Create view from the DataFrame\n\nHint:\n* use createOrReplaceTempView",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:11.245",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232020_-1334701350",
      "id": "paragraph_1575231292801_656111178",
      "dateCreated": "2019-12-06 07:20:32.020",
      "dateStarted": "2019-12-06 07:24:11.282",
      "dateFinished": "2019-12-06 07:24:11.286",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// your code here:\nusersDF.createOrReplaceTempView(\"usersDF\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:11.386",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232022_-483000987",
      "id": "paragraph_1575231320892_1752203464",
      "dateCreated": "2019-12-06 07:20:32.022",
      "dateStarted": "2019-12-06 07:24:11.420",
      "dateFinished": "2019-12-06 07:24:11.562",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the query plan with stats\n\nHint:\n* run sql EXPLAIN COST on query with filter user_id \u003c -1000",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:11.623",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232023_1987280165",
      "id": "paragraph_1575231476940_-83413734",
      "dateCreated": "2019-12-06 07:20:32.023",
      "dateStarted": "2019-12-06 07:24:11.652",
      "dateFinished": "2019-12-06 07:24:11.656",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"EXPLAIN COST select * from usersDF where user_id \u003c -1000\").show(truncate\u003dfalse)\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:11.752",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232026_2135965629",
      "id": "paragraph_1575314971994_-2105488670",
      "dateCreated": "2019-12-06 07:20:32.026",
      "dateStarted": "2019-12-06 07:24:11.782",
      "dateFinished": "2019-12-06 07:24:12.178",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Now save the table using metastore\n\nHint\n* use saveAsTable()\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:12.186",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232028_521185012",
      "id": "paragraph_1575314974515_1780943587",
      "dateCreated": "2019-12-06 07:20:32.028",
      "dateStarted": "2019-12-06 07:24:12.244",
      "dateFinished": "2019-12-06 07:24:12.248",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "\nusersDF\n  .write\n  .mode(\"overwrite\")\n  .option(\"path\", usersOutputPath)\n  .saveAsTable(tableName)\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:12.346",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232030_2036803586",
      "id": "paragraph_1575314976199_-375234612",
      "dateCreated": "2019-12-06 07:20:32.030",
      "dateStarted": "2019-12-06 07:24:12.394",
      "dateFinished": "2019-12-06 07:24:14.565",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the query plan again\n\n* Now read the table from metastore\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:14.638",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232031_-1194287835",
      "id": "paragraph_1575314978166_-970040033",
      "dateCreated": "2019-12-06 07:20:32.031",
      "dateStarted": "2019-12-06 07:24:14.660",
      "dateFinished": "2019-12-06 07:24:14.676",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"EXPLAIN COST select * from users where user_id \u003c -1000\").show(truncate\u003dfalse)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:14.760",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232032_-861727099",
      "id": "paragraph_1575315057461_1912232642",
      "dateCreated": "2019-12-06 07:20:32.032",
      "dateStarted": "2019-12-06 07:24:14.789",
      "dateFinished": "2019-12-06 07:24:15.065",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the statistics for the table\n\nHint\n* use sql DESC EXTENDED",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:15.094",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232034_705838579",
      "id": "paragraph_1575315059407_1946858652",
      "dateCreated": "2019-12-06 07:20:32.034",
      "dateStarted": "2019-12-06 07:24:15.125",
      "dateFinished": "2019-12-06 07:24:15.129",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"DESC EXTENDED users\").show(numRows\u003d50, truncate\u003d50)\n",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:15.225",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232035_182410601",
      "id": "paragraph_1575315062246_562386941",
      "dateCreated": "2019-12-06 07:20:32.035",
      "dateStarted": "2019-12-06 07:24:15.247",
      "dateFinished": "2019-12-06 07:24:15.483",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Compute the statistics\n\nHint\n* run sql ANALYZE TABLE ... COMPUTE STATISTICS",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:15.553",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232036_-874599778",
      "id": "paragraph_1575315125916_511617739",
      "dateCreated": "2019-12-06 07:20:32.036",
      "dateStarted": "2019-12-06 07:24:15.582",
      "dateFinished": "2019-12-06 07:24:15.588",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"ANALYZE TABLE users COMPUTE STATISTICS\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:15.686",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://10.13.4.90:4041/jobs/job?id\u003d4"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1575613232037_303433489",
      "id": "paragraph_1575315128867_1427272487",
      "dateCreated": "2019-12-06 07:20:32.037",
      "dateStarted": "2019-12-06 07:24:15.714",
      "dateFinished": "2019-12-06 07:24:16.346",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:16.421",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232039_-1294708525",
      "id": "paragraph_1575315212295_1899646874",
      "dateCreated": "2019-12-06 07:20:32.039",
      "dateStarted": "2019-12-06 07:24:16.450",
      "dateFinished": "2019-12-06 07:24:16.453",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"DESC EXTENDED users\").show(30, 50)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:16.554",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232040_2002915405",
      "id": "paragraph_1575315224819_-1992405238",
      "dateCreated": "2019-12-06 07:20:32.040",
      "dateStarted": "2019-12-06 07:24:16.584",
      "dateFinished": "2019-12-06 07:24:16.803",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the query plan for the query again",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:16.890",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232041_-1281329418",
      "id": "paragraph_1575315245149_-617875177",
      "dateCreated": "2019-12-06 07:20:32.041",
      "dateStarted": "2019-12-06 07:24:16.914",
      "dateFinished": "2019-12-06 07:24:16.917",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"EXPLAIN COST select * from users where user_id \u003c -1000\").show(30, false)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:17.017",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232042_1674381832",
      "id": "paragraph_1575315259406_-1930134814",
      "dateCreated": "2019-12-06 07:20:32.042",
      "dateStarted": "2019-12-06 07:24:17.038",
      "dateFinished": "2019-12-06 07:24:17.216",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See column level stats\n\nHint\n* use DESC EXTENDED table_name, col_name",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:17.238",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232044_-1248373820",
      "id": "paragraph_1575315277037_-1859781353",
      "dateCreated": "2019-12-06 07:20:32.044",
      "dateStarted": "2019-12-06 07:24:17.262",
      "dateFinished": "2019-12-06 07:24:17.266",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"DESC EXTENDED users user_id\").show(50, 60)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:17.365",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232045_1592587747",
      "id": "paragraph_1575315292708_-1171760302",
      "dateCreated": "2019-12-06 07:20:32.045",
      "dateStarted": "2019-12-06 07:24:17.387",
      "dateFinished": "2019-12-06 07:24:17.664",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Compute column level stats\n\nHint:\n* use ANALYZE TABLE table_name COMPUTE STATISTICS FOR COLUMNS col_names",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:17.691",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232046_1548307236",
      "id": "paragraph_1575315308755_-1987522800",
      "dateCreated": "2019-12-06 07:20:32.046",
      "dateStarted": "2019-12-06 07:24:17.719",
      "dateFinished": "2019-12-06 07:24:17.723",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"ANALYZE TABLE users COMPUTE STATISTICS FOR COLUMNS user_id, display_name\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:17.820",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232047_-13877108",
      "id": "paragraph_1575315331824_-1827861386",
      "dateCreated": "2019-12-06 07:20:32.047",
      "dateStarted": "2019-12-06 07:24:17.840",
      "dateFinished": "2019-12-06 07:24:19.204",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:19.262",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232047_1699034843",
      "id": "paragraph_1575315350861_449754157",
      "dateCreated": "2019-12-06 07:20:32.048",
      "dateStarted": "2019-12-06 07:24:19.310",
      "dateFinished": "2019-12-06 07:24:19.319",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"DESC EXTENDED users user_id\").show(30, 60)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:19.405",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232048_-1108852964",
      "id": "paragraph_1575315364829_1810478341",
      "dateCreated": "2019-12-06 07:20:32.048",
      "dateStarted": "2019-12-06 07:24:19.435",
      "dateFinished": "2019-12-06 07:24:19.660",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"EXPLAIN COST select * from users where user_id \u003c -1000\").show(30, false)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:25:35.978",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613531554_-1014572503",
      "id": "20191206-072531_704530750",
      "dateCreated": "2019-12-06 07:25:31.554",
      "dateStarted": "2019-12-06 07:25:35.998",
      "dateFinished": "2019-12-06 07:25:36.194",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### Compute the histogram for specific cols\n\nHint\n* Check if histogram is enabled\n* Enable if not\n* Compute column level stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:19.740",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232049_1411716614",
      "id": "paragraph_1575315394248_-2039248615",
      "dateCreated": "2019-12-06 07:20:32.049",
      "dateStarted": "2019-12-06 07:24:19.772",
      "dateFinished": "2019-12-06 07:24:19.776",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.conf.get(\"spark.sql.statistics.histogram.enabled\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:19.874",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232050_2069075302",
      "id": "paragraph_1575315412599_1323001613",
      "dateCreated": "2019-12-06 07:20:32.050",
      "dateStarted": "2019-12-06 07:24:19.894",
      "dateFinished": "2019-12-06 07:24:20.014",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.conf.set(\"spark.sql.statistics.histogram.enabled\", true)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:20.102",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232051_2012709504",
      "id": "paragraph_1575315425269_-1721674807",
      "dateCreated": "2019-12-06 07:20:32.051",
      "dateStarted": "2019-12-06 07:24:20.128",
      "dateFinished": "2019-12-06 07:24:20.255",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"ANALYZE TABLE users COMPUTE STATISTICS FOR COLUMNS user_id\")",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:20.329",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232052_-839733559",
      "id": "paragraph_1575315447660_-1039302333",
      "dateCreated": "2019-12-06 07:20:32.052",
      "dateStarted": "2019-12-06 07:24:20.351",
      "dateFinished": "2019-12-06 07:24:21.481",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md #### See the stats again",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:21.577",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232053_1058442385",
      "id": "paragraph_1575315461735_-2141789712",
      "dateCreated": "2019-12-06 07:20:32.053",
      "dateStarted": "2019-12-06 07:24:21.597",
      "dateFinished": "2019-12-06 07:24:21.601",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "spark.sql(\"DESC EXTENDED users user_id\").show(20, 60)",
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:21.700",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "runOnSelectionChange": true,
        "title": false,
        "checkEmpty": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232054_152172695",
      "id": "paragraph_1575315474524_1196017264",
      "dateCreated": "2019-12-06 07:20:32.054",
      "dateStarted": "2019-12-06 07:24:21.727",
      "dateFinished": "2019-12-06 07:24:21.966",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "user": "anonymous",
      "dateUpdated": "2019-12-06 07:24:22.035",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1575613232055_542750779",
      "id": "paragraph_1575403687493_1105472643",
      "dateCreated": "2019-12-06 07:20:32.055",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "solutions/cbo/cbo-II",
  "id": "2EUT3CJ3P",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}